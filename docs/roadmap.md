# LunchNow MVPロードマップ

## ドキュメント概要
- **目的**: MVP完成までのタスク管理と進捗の可視化
- **対象**: プロジェクトオーナーおよびAIコーディングエージェント
- **更新方法**: タスク完了時にチェックマーク（✅）を付ける

## タスクロードマップ

### フェーズ1: 環境構築・設計 ✅
- [✅] **プロジェクト初期化**
  - [✅] Next.js 15プロジェクト作成
    - [✅] create-next-appの実行
    - [✅] App Routerの有効化
    - [✅] 初期ファイル整理
  - [✅] Git環境のセットアップ
    - [✅] Gitリポジトリの初期化
    - [✅] .gitignoreファイルの作成
    - [✅] 初期コミットの実行
    - [✅] mainとdevelopブランチの作成
  - [✅] TypeScript、ESLint、Prettierの設定
    - [✅] tsconfig.jsonの最適化
    - [✅] ESLint設定ファイル作成
    - [✅] Prettier設定ファイル作成
  - [✅] ディレクトリ構造の整備
    - [✅] src/ディレクトリ作成
    - [✅] app/ディレクトリ構成設計
    - [✅] components/ディレクトリ構成設計
    - [✅] hooks/（カスタムフック）ディレクトリ作成
    - [✅] lib/（ユーティリティ関数）ディレクトリ作成
    - [✅] types/（共通型定義）ディレクトリ作成
    - [✅] api/（APIクライアント関数）ディレクトリ作成

- [✅] **依存関係のセットアップ**
  - [✅] Tailwind CSS導入
    - [✅] パッケージインストール
    - [✅] 設定ファイル作成
    - [✅] カラーテーマ設定
    - [✅] カスタムユーティリティ定義
  - [✅] shadcn/ui基本コンポーネント設定
    - [✅] CLIセットアップ
    - [✅] 必要コンポーネント選定
    - [✅] コンポーネントインストール
    - [✅] テーマカスタマイズ
  - [✅] SWRセットアップ
    - [✅] パッケージインストール
    - [✅] グローバル設定（キャッシュ設定など）
    - [✅] カスタムフェッチャー作成
    - [✅] エラーハンドリング設定

- [✅] **Supabase連携準備**
  - [✅] Supabase CLIのインストールと設定
    - [✅] Docker環境の確認
    - [✅] `supabase init`コマンドによるプロジェクト初期化
    - [✅] スキーマファイル作成ディレクトリ構造整備
  - [✅] ローカル開発環境でのSupabase起動
    - [✅] `supabase start`コマンドによるローカルサーバー起動
    - [✅] ローカルダッシュボードへのアクセス確認
  - [✅] 環境変数設定（開発環境）
    - [✅] `.env.local`ファイルへの環境変数追加
  - [✅] Supabaseクライアント設定
    - [✅] クライアントライブラリのインストール
    - [✅] 初期化コード作成
    - [✅] 型定義の準備
  - [✅] セキュリティ設定
    - [✅] RLS（Row Level Security）ポリシー設計
    - [✅] 匿名ユーザーアクセスルール設定

- [✅] **ベース設計実装**
  - [✅] ルーティング設定（App Router）
    - [✅] 基本ページ構造の定義
    - [✅] ルートレイアウト作成
    - [✅] エラーページ設定
  - [✅] レイアウトコンポーネント作成
    - [✅] 共通ヘッダー設計
    - [✅] フッター設計
    - [✅] ページコンテナ作成
  - [✅] 共通ユーティリティ関数定義
    - [✅] 日付・時間操作関数
    - [✅] フォーマット関数
    - [✅] バリデーション関数
  - [✅] 型定義ファイル作成
    - [✅] データモデル型定義
    - [✅] API型定義
    - [✅] コンポーネント型定義

### フェーズ2: データ層実装
- [ ] **データベーススキーマ作成**
  - [ ] users（ユーザープロフィール）テーブル
    - [ ] テーブル定義（カラム・型）
    - [ ] インデックス設定
    - [ ] RLSポリシー設定
  - [ ] likes（いいね）テーブル
    - [ ] テーブル定義（カラム・型）
    - [ ] インデックス設定
    - [ ] RLSポリシー設定
  - [ ] matches（マッチング）テーブル
    - [ ] テーブル定義（カラム・型）
    - [ ] インデックス設定
    - [ ] RLSポリシー設定
  - [ ] messages（メッセージ）テーブル
    - [ ] テーブル定義（カラム・型）
    - [ ] インデックス設定
    - [ ] RLSポリシー設定
  - [ ] マイグレーションスクリプト作成
    - [ ] 初期スキーマ作成SQL
    - [ ] シードデータSQL

- [ ] **API実装: ユーザー**
  - [ ] ユーザー作成・更新API
    - [ ] ユーザー登録処理実装
    - [ ] プロフィール更新処理実装
    - [ ] クライアント側関数作成
  - [ ] ユーザー取得API
    - [ ] 単一ユーザー取得処理
    - [ ] クライアント側関数作成
  - [ ] 募集中ユーザー一覧取得API
    - [ ] フィルター条件設計
    - [ ] クエリ最適化
    - [ ] クライアント側関数作成

- [ ] **API実装: マッチング**
  - [ ] いいね登録・取得API
    - [ ] いいね登録処理実装
    - [ ] いいねリスト取得処理
    - [ ] クライアント側関数作成
  - [ ] マッチング判定・登録API
    - [ ] 相互いいね判定ロジック
    - [ ] マッチ登録処理
    - [ ] クライアント側関数作成
  - [ ] マッチキャンセルAPI
    - [ ] キャンセル処理実装
    - [ ] 相互Like削除処理
    - [ ] クライアント側関数作成

- [ ] **API実装: メッセージ**
  - [ ] メッセージ送信API
    - [ ] メッセージ保存処理
    - [ ] クライアント側関数作成
  - [ ] メッセージ履歴取得API
    - [ ] 履歴取得処理
    - [ ] ページネーション対応
    - [ ] クライアント側関数作成

### フェーズ3: UI基盤構築
- [ ] **共通UIコンポーネント作成**
  - [ ] Button/TextField/SelectField実装
    - [ ] Buttonコンポーネント（バリエーション含む）
    - [ ] TextFieldコンポーネント（バリデーション含む）
    - [ ] SelectFieldコンポーネント
  - [ ] Card/MessageBubble実装
    - [ ] Cardコンポーネント（ユーザーカード用）
    - [ ] MessageBubbleコンポーネント（送信・受信別）
  - [ ] Modal/Toast実装
    - [ ] Modalコンポーネント
    - [ ] Toastコンポーネント
    - [ ] 表示・非表示制御関数
  - [ ] ローディング表示実装
    - [ ] スピナーコンポーネント
    - [ ] スケルトンローディングコンポーネント

- [ ] **レイアウト実装**
  - [ ] PageContainerコンポーネント
    - [ ] 共通パディング・マージン設定
    - [ ] レスポンシブ対応
  - [ ] ヘッダー/フッター実装
    - [ ] ヘッダーナビゲーション
    - [ ] フッター情報表示
  - [ ] レスポンシブデザイン対応
    - [ ] ブレークポイント設定
    - [ ] モバイルファースト対応
    - [ ] 画面サイズ別レイアウト調整

- [ ] **ユーティリティ作成**
  - [ ] 日時ユーティリティ
    - [ ] 現在時刻からのend_time選択肢生成関数（~HH:MM形式）
    - [ ] 日付フォーマット関数（その他の日時表示用）
  - [ ] フォームバリデーション
    - [ ] 必須入力チェック
    - [ ] 文字数チェック
    - [ ] 特殊文字チェック
  - [ ] LocalStorage操作関数
    - [ ] ユーザーID保存・取得
    - [ ] 設定保存・取得
  - [ ] APIフック作成
    - [ ] useSWRラッパー関数
    - [ ] API呼び出し共通関数

### フェーズ4: 画面実装
- [ ] **ランチ設定画面（/setup）**
  - [ ] プロフィール入力フォーム
    - [ ] ニックネーム入力欄
    - [ ] 学年選択欄
    - [ ] 学部選択欄
  - [ ] ステータス入力フォーム
    - [ ] 空き時間選択機能
    - [ ] 場所選択機能
  - [ ] バリデーション処理
    - [ ] フロントエンドバリデーション
    - [ ] エラーメッセージ表示
  - [ ] API連携（保存・取得）
    - [ ] 保存処理連携
    - [ ] 初期値取得処理

- [ ] **ユーザー一覧画面（/users）**
  - [ ] 募集中ユーザーカード表示
    - [ ] ユーザーカードコンポーネント
    - [ ] 一覧レイアウト
    - [ ] 空状態表示
  - [ ] 手動リロード機能
    - [ ] リロードボタン
    - [ ] ローディング表示
  - [ ] いいね機能
    - [ ] いいねボタン
    - [ ] いいね状態表示
  - [ ] マッチングポップアップ
    - [ ] マッチング通知モーダル
    - [ ] マッチング後のアクション選択

- [ ] **チャット画面（/chat）**
  - [ ] チャットUIレイアウト
    - [ ] メッセージリスト表示
    - [ ] 送信フォーム
    - [ ] スクロール制御
  - [ ] メッセージ送受信
    - [ ] メッセージ送信処理
    - [ ] 送信状態表示
    - [ ] エラーハンドリング
  - [ ] ポーリング処理実装
    - [ ] 定期的データ取得
    - [ ] 画面表示更新
    - [ ] バックグラウンド制御
  - [ ] マッチングキャンセル機能
    - [ ] キャンセルボタン
    - [ ] 確認ダイアログ
    - [ ] キャンセル処理実行

- [ ] **画面遷移とリダイレクト**
  - [ ] ルート（/）からのリダイレクト
    - [ ] 初期アクセス判定
    - [ ] 適切なページへの遷移
  - [ ] 認証状態に基づく制御
    - [ ] 未認証時のリダイレクト
    - [ ] 認証済み時の制御
  - [ ] エラー画面
    - [ ] 404ページ実装
    - [ ] エラーハンドリング共通処理

### フェーズ5: 機能連携・テスト
- [ ] **統合テスト**
  - [ ] 基本フロー（登録→一覧→マッチング→チャット）
    - [ ] 正常系テスト
    - [ ] 異常系テスト
  - [ ] エラーケース確認
    - [ ] ネットワークエラー時
    - [ ] サーバーエラー時
    - [ ] バリデーションエラー時
  - [ ] レスポンシブ対応確認
    - [ ] モバイル表示テスト
    - [ ] タブレット表示テスト
    - [ ] デスクトップ表示テスト

- [ ] **パフォーマンス最適化**
  - [ ] SWRキャッシュ調整
    - [ ] キャッシュ時間設定
    - [ ] 再検証戦略設定
  - [ ] バンドルサイズ最適化
    - [ ] コード分割
    - [ ] 不要コード削減
  - [ ] 画像・アセット最適化
    - [ ] 画像圧縮
    - [ ] 遅延読み込み設定

- [ ] **デプロイ準備・実行**
  - [ ] 環境変数設定
    - [ ] 本番環境用変数定義
    - [ ] シークレット登録
  - [ ] 本番用Supabaseプロジェクト作成（デプロイ直前）
    - [ ] リモートプロジェクト作成
    - [ ] 管理者アカウント設定
    - [ ] 本番環境セキュリティ設定
  - [ ] ローカルDBからSupabaseプロジェクトへのマイグレーション
    - [ ] スキーマ移行
    - [ ] シードデータ移行
    - [ ] 移行確認テスト
  - [ ] Supabaseプロジェクトの本番設定確認
    - [ ] RLSポリシー確認
    - [ ] API権限確認
    - [ ] パフォーマンス設定確認
  - [ ] フロントエンドのビルド確認
    - [ ] ビルドエラー解消
    - [ ] ビルドサイズ確認
  - [ ] Vercelへのデプロイ実行
    - [ ] デプロイ設定
    - [ ] リリース実行
    - [ ] デプロイ後テスト

- [ ] **最終調整**
  - [ ] エッジケースの確認
    - [ ] データ欠損時の挙動確認
    - [ ] 極端な入力値での動作確認
    - [ ] 同時操作時の整合性確認
  - [ ] UX改善
    - [ ] ユーザーフィードバック収集
    - [ ] 操作性改善
    - [ ] エラーメッセージ改善
  - [ ] ドキュメント更新
    - [ ] README更新
    - [ ] デプロイ手順書作成
    - [ ] 要件定義書最終化

## 使用方法
1. タスク完了時にチェックボックスを埋める（`[ ]` → `[x]`）
2. 進捗状況に応じてタスクの追加・変更を行う
3. MVPの要件に沿って優先順位を調整する

## 開発フロー
1. Supabase CLIを使用してローカル環境で開発
2. ローカル環境での動作確認と調整
3. デプロイ直前に本番用Supabaseプロジェクトを作成
4. ローカルDBから本番環境へマイグレーション
5. Vercelへのフロントエンドデプロイ

## 注意事項
- MVPの目的は「最小限の機能で実用的な製品を迅速に完成させる」こと
- 要件定義（`/docs`）から逸脱する変更は事前承認と文書更新が必要
- 作業はAIコーディングエージェントとユーザーの協力で進める
- ローカル開発を基本とし、本番環境への移行は最終段階で行う
